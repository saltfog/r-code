{
    "contents" : "#======================================================================\n# Week 3 Inference III\n#======================================================================\nbabies = read.table(\"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt\", header=TRUE)\n#imports\nbabies = read.table(\"babies.txt\", header=TRUE)\nbwt.nonsmoke = babies$bwt[babies$smoke==0]\nbwt.smoke = babies$bwt[babies$smoke==1]\n\n# QUESTION 1.1\n# How often (what proportion of simulations) is the sample variance greater than 1.5 times the population variance?\npop.var = var(bwt.nonsmoke)\nvars = replicate(1000, var(sample(bwt.nonsmoke,10)))\nmean(vars > pop.var*1.5)\n\n# QUESTION 1.2\n# Now use a sample size of 50. How often (what proportion) is the sample variance larger than 1.5 times the population variance?\nvars = replicate(1000, var(sample(bwt.nonsmoke,50)))\nmean(vars > pop.var*1.5)\n\n# QUESTION 2.1\n# What is the p-value for the two groups of 50 defined above?\nset.seed(0)\nN=50\nsmokers <- sample(babies$bwt[babies$smoke==1],N)\nnonsmokers <- sample(babies$bwt[babies$smoke==0],N)\nobs <- mean(smokers)-mean(nonsmokers)\n\navgdiff <- replicate(1000, {\n  all <- sample(c(smokers,nonsmokers))\n  smokersstar <- all[1:N]\n  nonsmokersstar <- all[(N+1):(2*N)]\n  return(mean(smokersstar) - mean(nonsmokersstar))\n})\nmean(abs(avgdiff) > abs(obs))\n\n#Plotting\nsample.size = 2:400\nvar.estimate = sapply(sample.size, function(n) var(sample(bwt.nonsmoke, n)))\n\nplot(sample.size, var.estimate)\nabline(h=pop.var, col=\"blue\")\n",
    "created" : 1432268670548.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2454226177",
    "id" : "9FA22F91",
    "lastKnownWriteTime" : 1432269034,
    "path" : "~/Downloads/Statistics_and_R_for_the_Life_Sciences-master/Week_3_Inference_3.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}