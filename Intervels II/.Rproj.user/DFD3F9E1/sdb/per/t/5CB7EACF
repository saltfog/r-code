{
    "contents" : "#imports\nbabies = read.table(\"babies.txt\", header=TRUE)\n\n#You can extract the baby birthweights from smoking and non-smoking mothers with the code:\n\nbwt.nonsmoke = babies$bwt[babies$smoke==0]\nbwt.smoke = babies$bwt[babies$smoke==1]\n\n# QUESTION 1.1\n# What is the average length of the confidence interval?\nN=30\nconf.int<-function(){\n  sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)\n  sample.bwt.smoke <- sample(bwt.smoke,N)\n  bwt.test <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)\n  return (bwt.test$conf.int[2] - bwt.test$conf.int[1])\n}\nmean(replicate(1000, conf.int()))\n\n# QUESTION 1.2\n# How often (what proportion of times) did the confidence intervals contain the population-level\n#difference?\npopdiff = mean(bwt.nonsmoke) - mean(bwt.smoke)\nN=30\ndiff.compare<-function(){\n  sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)\n  sample.bwt.smoke <- sample(bwt.smoke,N)\n  bwt.test <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)\n  return (popdiff>bwt.test$conf.int[1] & popdiff<bwt.test$conf.int[2])\n}\nmean(replicate(1000, diff.compare()))\n\n#difference between means\nt.test(bwt.nonsmoke, bwt.smoke)\nsample <- t.test(bwt.nonsmoke, bwt.smoke)\nsample$p.value\nsample$conf.int\n\n# QUESTION 3.1\n# What is the power at alpha=0.1?\nN=15\nreject <- function(N,alpha){\n  sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)\n  sample.bwt.smoke <- sample(bwt.smoke,N)\n  pval <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)$p.value\n  ifelse(pval < alpha,1,0)\n}\nmean(replicate(1000,reject(N,0.1)))\n\n# QUESTION 3.2\n# What is the power at alpha=0.05?\nmean(replicate(1000,reject(N,0.05)))\n\n# QUESTION 3.3\n# What is the power at alpha=0.01?\nmean(replicate(1000,reject(N,0.01)))\n\n#======================================================================\n# Week 3 Inference III\n#======================================================================\nbabies = read.table(\"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt\", header=TRUE)\nbwt.nonsmoke = babies$bwt[babies$smoke==0]\nbwt.smoke = babies$bwt[babies$smoke==1]\n# QUESTION 1.1\n# How often (what proportion of simulations) is the sample variance greater than 1.5 times the population variance?\npop.var = var(bwt.nonsmoke)\nvars = replicate(1000, var(sample(bwt.nonsmoke,10)))\nmean(vars > pop.var*1.5)\n",
    "created" : 1432268790427.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "343795924",
    "id" : "5CB7EACF",
    "lastKnownWriteTime" : 1432268613,
    "path" : "~/r_data/Intervels II/Intervels II.R",
    "project_path" : "Intervels II.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}